## Hindi OCR ML Algorithm Comparison

This project compares various machine learning algorithms for Optical Character Recognition (OCR) of handwritten Hindi (Devanagari) characters. The goal is to evaluate the performance of CNN, LightGBM, and XGBoost models on the `Devanagari-Handwritten-Character-Dataset`.

## Table of Contents
- [Project Overview](#project-overview)
- [Dataset](#dataset)
- [Installation](#installation)
- [Usage](#usage)
- [Results](#results)
- [License](#license)
- [Script Analysis](#script-analysis)

## Project Overview
This repository contains scripts to train, evaluate, and test machine learning models for recognizing handwritten Devanagari characters. The project includes:
- `Hindi.py`: Trains and saves CNN, LightGBM, and XGBoost models.
- `check.py`: Tests a single image with all three models.
- `performance_metrics.py`: Evaluates model performance and generates confusion matrices.

## Dataset
The dataset used is the `Devanagari-Handwritten-Character-Dataset`. To keep the repository size manageable, it is included as a compressed file (`Devanagari-Handwritten-Character-Dataset.zip`).

### Steps to Prepare the Dataset
1. Download or clone this repository.
2. Locate the `Devanagari-Handwritten-Character-Dataset.zip` file in the root directory.
3. Unzip the file in the same directory to create the `Devanagari-Handwritten-Character-Dataset` folder:
   - On Windows: Right-click the `.zip` file and select "Extract All" to the current directory.
   - On macOS/Linux: Run `unzip Devanagari-Handwritten-Character-Dataset.zip` in the terminal.
4. After unzipping, you should have the following structure:
   - `Devanagari-Handwritten-Character-Dataset/Train/`: Training images
   - `Devanagari-Handwritten-Character-Dataset/Test/`: Test images

## Installation
1. Clone this repository:
   ```bash
   git clone https://github.com/your-username/Hindi-OCR-ML-Algo-Comparison.git
   cd Hindi-OCR-ML-Algo-Comparison
   ```
2. Unzip the dataset as described above.
3. Install the required dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Usage
### Step 1: Train the Models
Run the training script to train and save the models:
```bash
python Hindi.py
```
- This script trains a CNN model (saved as `cnn_model_final.keras` and `best_cnn_model.keras` via checkpoint), a LightGBM model (saved as `lgbm_model.pkl`), and an XGBoost model (saved as `xgb_model.pkl`).
- Output: Prints accuracy scores for each model.

### Step 2: Evaluate Model Performance
Run the performance metrics script to evaluate the models on the test set:
```bash
python performance_metrics.py
```
- This script computes accuracy, precision, recall, F1 score, and inference time for each model.
- Generates confusion matrices as plots (saved as images).

### Step 3: Test a Single Image
Run the check script to predict a single image with all models:
```bash
python check.py
```
- By default, it uses the image at `Devanagari-Handwritten-Character-Dataset/Train/character_21_pa/1637.png`.
- To test a different image, update the `image_path` variable in `check.py` to the desired image path (e.g., `Devanagari-Handwritten-Character-Dataset/Test/character_10_yna/1407.png`).
- Output: Prints the predicted Devanagari character (e.g., "pa", "yna") for each model.

## Results
The following files are generated or used:
- `cnn_model_final.keras`: Final trained CNN model
- `best_cnn_model.keras`: Best CNN model checkpoint
- `lgbm_model.pkl`: Trained LightGBM model
- `xgb_model.pkl`: Trained XGBoost model
- `model_accuracy.png`: Accuracy comparison (generated by `performance_metrics.py`)
- `cnn_confusion_matrix.png`: CNN confusion matrix
- `lightGBM_confusion_matrix.png`: LightGBM confusion matrix
- `xgboost_confusion_matrix.png`: XGBoost confusion matrix

## License
This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## Script Analysis
### 1. Hindi.py
- **Purpose**: Trains and saves three models (CNN, LightGBM, XGBoost) using the `DevanagariHandwrittenCharacterDataset`.
- **Key Functionality**:
  - Uses `ImageDataGenerator` for data augmentation (rotation, shift, shear, zoom) and rescaling.
  - Defines a CNN model with Conv2D, MaxPooling2D, BatchNormalization, Dropout, and Dense layers.
  - Implements EarlyStopping and ModelCheckpoint callbacks for training.
  - Trains the CNN model for 30 epochs and saves it as `cnn_model_final.keras`.
  - Flattens images for LightGBM and XGBoost, trains these models, and saves them as `lgbm_model.pkl` and `xgb_model.pkl`.
  - Prints accuracy scores for all models.
- **Dependencies**: `tensorflow`, `keras`, `numpy`, `lightgbm`, `xgboost`, `sklearn`.
- **Notes**: Assumes the dataset is unzipped in `DevanagariHandwrittenCharacterDataset/Train` and `DevanagariHandwrittenCharacterDataset/Test`.

### 2. check.py
- **Purpose**: Tests a single image with all three trained models (CNN, LightGBM, XGBoost) for prediction.
- **Key Functionality**:
  - Loads the saved models (`best_cnn_model.keras`, `lgbm_model.pkl`, `xgb_model.pkl`).
  - Preprocesses an image (resizes to 32x32, converts to grayscale, normalizes).
  - Makes predictions and prints the predicted Devanagari character labels (e.g., "ka", "kha", etc.).
- **Dependencies**: `tensorflow`, `keras`, `numpy`, `cv2`, `lightgbm`, `xgboost`.
- **Notes**: Uses a hardcoded image path (`1637.png` from `Train/character_21_pa`). The label list is predefined with 36 Devanagari characters.

### 3. performance_metrics.py
- **Purpose**: Evaluates the performance of all three models on the test set and generates confusion matrices.
- **Key Functionality**:
  - Loads the saved models.
  - Uses `ImageDataGenerator` to load and preprocess test data.
  - Flattens data for LightGBM and XGBoost.
  - Computes accuracy, precision, recall, F1 score, and inference time for each model.
  - Plots confusion matrices using `matplotlib` and `seaborn`.
- **Dependencies**: `tensorflow`, `keras`, `numpy`, `sklearn`, `time`, `matplotlib`, `seaborn`.
- **Notes**: Assumes the test data is in `DevanagariHandwrittenCharacterDataset/Test`. The script generates visual outputs (confusion matrices).

## License

This project is licensed under the MIT License - see the [LICENSE] file for details.

---
## Contact

ðŸ“§ Email: srirajsarkar2000@gmail.com
